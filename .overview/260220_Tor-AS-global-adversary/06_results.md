# 06. 분석 결과

> 실행일: 2026-02-20
> 조건: 90일, 50 클라이언트, 3개 CAIDA 스냅샷, 3건 BGP 공격, seed=42

---

## 1. 전체 상관율 비교

| 시나리오 | 상관 회로 | 전체 회로 | 상관율 | Vanilla 대비 감소 |
|----------|----------|----------|--------|-------------------|
| **Vanilla** (방어 없음) | 37,572 | 1,944,150 | **1.93%** | — |
| **Counter-RAPTOR** | 35,856 | 1,944,150 | **1.84%** | -4.6% |
| **Astoria** | 12 | 1,944,150 | **~0.00%** | **-99.97%** |
| **Combined** (CR+Astoria) | 5 | 1,944,150 | **~0.00%** | **-99.99%** |

### 해석

- **Counter-RAPTOR 단독**: Guard 재가중만으로는 상관율 감소가 미미하다 (4.6%). Guard를 변경해도 transit 경로는 여전히 겹칠 수 있기 때문이다.
- **Astoria 단독**: entry/exit transit 교집합 검사가 상관을 **사실상 완전히 제거**한다 (99.97%). 남은 12건은 fallback 회로에서 발생.
- **Combined**: Astoria가 이미 대부분의 상관을 제거하므로, CR의 추가 효과는 fallback 회로에서의 미세한 추가 감소(12→5건)에 그친다.

---

## 2. 클라이언트 침해율

"침해"는 90일간 해당 클라이언트의 회로 중 **최소 1개가 상관된 경우**를 의미한다.

| 시나리오 | 침해 클라이언트 | 침해율 | Vanilla 대비 감소 |
|----------|----------------|--------|-------------------|
| Vanilla | 34/50 | **68%** | — |
| Counter-RAPTOR | 34/50 | **68%** | 0% |
| Astoria | 9/50 | **18%** | -73.5% |
| Combined | 5/50 | **10%** | -85.3% |

### 해석

- Vanilla에서 90일간 **68%의 클라이언트가 최소 1회 상관됨** — 방어 없이는 장기적으로 대부분의 사용자가 취약하다.
- Counter-RAPTOR는 전체 상관율은 낮추나, **침해 클라이언트 수는 줄이지 못한다** — 상관이 소수 클라이언트에 집중되지 않고 넓게 분포.
- Astoria는 침해율을 18%로 대폭 감소, Combined는 **10%까지 감소** — 소수의 fallback 회로에서만 침해 발생.

---

## 3. BGP 공격 영향 (Vanilla 기준)

3건의 BGP 공격에 대해 공격 전(pre), 공격 중(during), 공격 후(post) 상관율을 분석한다.

| 공격 | 유형 | 적대자 | 공격 전 | 공격 중 | 공격 후 | 배율 |
|------|------|--------|---------|---------|---------|------|
| #0 | Hijack | AS174 (Cogent, 단일 1 AS) | 1.84% | 1.66% | 1.95% | 0.90x |
| #1 | Interception | AS3356 (Level3, Tier-1 140 AS) | 1.74% | 1.95% | 2.13% | 1.12x |
| #2 | Hijack (국가) | AS3320 (DE, 73 AS) | 1.74% | **3.20%** | 2.29% | **1.84x** |

### 핵심 관찰

**단일 AS Hijack (#0)**: 공격 효과가 미미하다 (배율 0.90x — 오히려 감소). 단일 AS가 Hetzner의 경로를 장악해도 전체 상관 패턴에 큰 영향을 주지 않는다. 6시간이라는 짧은 지속 시간도 영향을 희석시킨다.

**Tier-1 Interception (#1)**: 소폭 상관율 증가 (1.12배). 140개 AS를 동원하여 368,638건의 관찰을 기록했으나, interception은 기존 provider를 유지하므로 경로 변경이 제한적이다. 은밀하지만 효과도 제한적.

**국가 수준 Hijack (#2)**: **1.84배 상관율 증가** (1.74% → 3.20%). 가장 위협적인 공격. 73개 DE AS가 AS6939(Hurricane Electric, 전체 transit의 17.7%)을 hijack하여 대규모 경로 변경을 유발했다.

**공격 후에도 상관율 상승 지속**: 모든 공격에서 공격 후(post) 상관율이 공격 전(pre)보다 높다. 이는 30일째 스냅샷 전환(토폴로지 변경)의 영향으로, BGP 공격의 잔류 효과가 아니라 자연적 churn에 의한 것이다.

---

## 4. 시간 추세 분석

| 시나리오 | 평균 | 표준편차 | 기울기(slope) | 추세 |
|----------|------|---------|------------|------|
| Vanilla | 1.93% | 0.34% | +0.0031 | **증가** |
| Counter-RAPTOR | 1.84% | 0.32% | +0.0026 | **증가** |
| Astoria | ~0.00% | ~0.00% | ~0 | **안정** |
| Combined | ~0.00% | ~0.00% | ~0 | **안정** |

### 해석

- **Vanilla/CR**: 시간이 지남에 따라 상관율이 증가하는 추세를 보인다. 토폴로지 churn(edge 변동)이 새로운 관찰 경로를 생성하기 때문이다. Tempest(2018)의 발견과 일치.
- **Astoria/Combined**: 시간 경과와 무관하게 안정적으로 0%에 가깝다. transit 교집합 검사가 토폴로지 변동에도 효과적으로 작동함을 의미.

---

## 5. Astoria 방어 통계

| 지표 | Astoria 단독 | Combined |
|------|-------------|----------|
| 총 검사 횟수 | 1,980,422 | 1,979,350 |
| 안전한 회로 (SAFE) | 1,944,149 | 1,944,149 |
| 거부된 위험 회로 (UNSAFE) | 36,273 | 35,201 |
| Fallback 회로 | 1 | 1 |
| **안전율** | **98.2%** | **98.2%** |

- 회로의 98.2%가 첫 시도 또는 5회 이내 재시도에서 안전한 회로를 찾았다.
- 전체 시뮬레이션(90일, 50 클라이언트)에서 fallback(모든 재시도 실패)은 **단 1건**.
- Combined에서 CR 가중치가 적용되어 거부 회로가 35,201건으로 약간 감소 (Astoria 단독 대비 -3%) — CR이 관찰 위험이 낮은 Guard를 선호하므로 교집합 발생 확률도 소폭 감소.

---

## 6. Transit AS 분포 (Vanilla)

상위 transit AS는 전체 관찰의 상당 부분을 차지한다:

| 순위 | AS | 관찰 비율 | 정체 |
|------|-----|----------|------|
| 1 | AS6939 | **17.7%** | Hurricane Electric (글로벌 transit) |
| 2 | AS24875 | 8.6% | NovoServe |
| 3 | AS50629 | 6.8% | LWLcom |
| 4 | AS199524 | 5.7% | G-Core Labs |
| 5 | AS49544 | 4.7% | i3D.net |
| 6 | AS174 | 4.0% | Cogent Communications |

- **상위 6개 AS가 전체 관찰의 47.5%를 점유** — 소수의 대형 transit AS가 관찰을 지배.
- **AS6939(HE)의 지배적 위치**: 전체 transit 관찰의 17.7%를 차지하여 BGP 공격 #2의 주요 타겟이 됨. 이 AS를 hijack하면 대규모 경로 변경이 발생하여 1.84배 상관율 증가.
- **Counter-RAPTOR의 한계**: Guard 선택만 변경하므로 transit AS의 지배적 위치는 변하지 않음. Astoria의 transit 교집합 검사가 이 문제를 직접 해결.

---

## 7. 시각화 6개 차트

### 7.1 시나리오별 상관율 비교 (Bar Chart)

**파일**: `tor-anal/output/analysis/plots/correlation_comparison.png`

4개 시나리오의 전체 상관율을 막대 차트로 비교. Vanilla(1.93%)와 CR(1.84%)이 유사한 높이, Astoria와 Combined는 사실상 0에 가까운 막대로 나타난다. 방어 전략의 효과 차이를 한눈에 보여준다.

### 7.2 시간별 상관율 변화 (Line Plot)

**파일**: `tor-anal/output/analysis/plots/temporal_curves.png`

3개 기간(30일 단위)에 걸친 상관율 변화를 라인 플롯으로 표시. Vanilla/CR은 우상향 추세(토폴로지 churn 영향), Astoria/Combined는 수평선(0%)에 가깝다. 시간적 위협에 대한 Astoria의 안정성을 보여준다.

### 7.3 누적 상관율 곡선 (Cumulative Curve)

**파일**: `tor-anal/output/analysis/plots/cumulative_compromise.png`

시간 경과에 따라 누적된 상관 회로 비율의 변화. Vanilla/CR은 지속적으로 증가하는 곡선을 보이며, Astoria/Combined는 매우 완만하게(사실상 수평으로) 유지된다.

### 7.4 공격 전/중/후 비교 (Grouped Bar Chart)

**파일**: `tor-anal/output/analysis/plots/attack_impact.png`

3건의 BGP 공격 각각에 대해 pre/during/post 상관율을 그룹 바 차트로 비교. 공격 #2(DE 국가 hijack)의 during 막대가 가장 높게 나타나며, 국가 수준 공격의 위협을 시각적으로 보여준다.

### 7.5 AS 위험도 히트맵 (Heatmap)

**파일**: `tor-anal/output/analysis/plots/as_risk_heatmap.png`

Top 20 transit AS의 entry/exit 관찰 빈도를 히트맵으로 표시. AS6939(HE)이 entry와 exit 모두에서 가장 높은 빈도를 보이며, 소수의 AS가 관찰을 지배하는 구조가 드러난다.

### 7.6 Guard 분포 변화 (Comparison Bar Chart)

**파일**: `tor-anal/output/analysis/plots/guard_distribution_shift.png`

Vanilla와 Counter-RAPTOR의 Guard AS 선택 분포를 비교. CR 적용 후 p_entry가 높은 AS(관찰 위험 큰 AS)의 선택 비율이 감소하고, p_entry가 낮은 AS(안전한 AS)의 비율이 증가하는 것을 보여준다.

---

## 8. 핵심 발견 정리

### RQ1에 대한 답변: AS-level 글로벌 관찰자의 상관 능력

> **Vanilla Tor에서 AS-level 글로벌 관찰자의 상관율은 1.93%이며, 90일간 50명 중 34명(68%)의 클라이언트가 최소 1회 상관된다.**

- 전체 상관율(1.93%)은 낮아 보이지만, 클라이언트 침해율(68%)이 보여주듯 장기간 관찰 시 대부분의 사용자가 취약해진다.
- 시간이 지남에 따라 상관율이 증가하는 추세(slope +0.0031)는 Tempest(2018)의 발견과 일치한다.
- **Astoria 방어가 가장 효과적**: 상관율 99.97% 감소, 클라이언트 침해율 68% → 18%.

### RQ2에 대한 답변: AS 위치의 영향

> **상위 6개 transit AS가 전체 관찰의 47.5%를 점유하며, AS6939(Hurricane Electric)은 단독으로 17.7%를 차지한다. 국가 수준 적대자가 이러한 핵심 AS를 BGP hijack하면 상관율이 1.84배 증가한다.**

- AS 위치(특히 transit 점유율)가 추적 성공률에 결정적 영향을 미친다.
- 단일 AS hijack(공격 #0)은 효과가 미미하나, 국가 수준 적대자(공격 #2)는 핵심 transit AS를 탈취하여 대규모 경로 변경을 유발, 유의미한 상관율 증가를 일으킨다.
- Tier-1 interception(공격 #1)은 은밀하지만 경로 변경이 제한적이어서 추가 상관으로 이어지지 않는다.
