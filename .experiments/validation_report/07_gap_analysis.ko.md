# 갭 분석: 구조적 한계와 주장에 대한 영향

**문서 버전**: 1.0
**날짜**: 2025-02-23
**범위**: 본 재현 실험과 원 논문 (RAPTOR, Johnson et al.) 간의 갭에 대한 체계적 식별 및 심각도 분류

---

## 1. 서론

본 문서는 AS-level Tor 트래픽 상관 실험과 원 논문 간의 구조적, 방법론적, 통계적 갭을 목록화한다. 각 갭에 대해 심각도를 평가하고, 영향받는 주장을 식별하며 (`01_validity_framework.md`의 Tier A/B/C 분류 참조), 가능한 경우 정량적 영향을 추정하고, 해결 가능성을 평가한다.

### 1.1 심각도 정의

| 심각도 | 정의 | 기준 |
|--------|------|------|
| **Critical** | 완화 없이 모든 주장에 대한 신뢰를 훼손 | 전체 결과 집합의 통계적 타당성에 영향 |
| **High** | 절대값에 영향을 미치며 정성적 결론을 변경할 수 있음 | 핵심 메트릭에 >5x 영향 |
| **Medium** | 특정 발견에 영향을 미치지만 주요 결론을 무효화하지 않음 | 특정 메트릭에 2-5x 영향 |
| **Low** | 완전성을 위해 인정하는 미미한 효과 | <2x 영향, 또는 이차적 메트릭에만 영향 |

---

## 2. 갭 심각도 분류표

| # | 갭 | 심각도 | 영향받는 주장 | 해결 가능? |
|---|-----|--------|-------------|-----------|
| G1 | 단일 시드 (분산 추정 없음) | **Critical** | 전체 (A1-A3, B1-B3, C1-C2) | 예 (S1 다중 시드 해결) |
| G2 | 토폴로지 규모 (727 vs ~48K AS) | **High** | 모든 절대값, B2, C1, C2 | 부분적 (토폴로지 확장) |
| G3 | BFS 라우팅 모델 (실제 BGP 대비) | **High** | B2, B3, C1 | 부분적 (V-스크립트로 정량화 가능) |
| G4 | Guard 수명 분포 | Medium | A1 CDF 형태 | 예 (S3 가변 수명 해결) |
| G5 | IXP 미모델링 | Medium | A3 관측 기회 | 아니오 (데이터 갭) |
| G6 | AS-level 릴레이 집계 | Low | AS 내 릴레이 다양성 | 아니오 (설계상) |
| G7 | 클라이언트 수 (방어 실험 50명) | Medium | A2 CDF 세분화 | 예 (200+로 증가) |
| G8 | 시간 해상도 (월간 vs 일간) | Medium | B1 churn 크기 | 부분적 (일간 CAIDA 미가용) |

---

## 3. 상세 갭 분석

### G1: 단일 시드 -- 분산 추정 없음

**심각도**: Critical

**설명**: 모든 실험이 단일 랜덤 시드 (RAPTOR: 시드 42, Johnson et al.: 기본 시드)로 실행되었다. 다중 독립 실행 없이는 보고된 메트릭의 분산을 추정하거나 신뢰구간을 구성하거나 관찰된 차이 (예: B2의 비대칭 라우팅 배수 1.003x)가 통계적으로 유의한지 판단할 수 없다.

**영향받는 주장**:
- **Tier A (A1-A3)**: 큰 효과 크기 (90.5% exit 지배, 99.97% Astoria 감소)가 시드 인공물일 가능성은 낮지만, 공식적 확인에는 분산 추정이 필요. 신뢰도: 높지만 미증명.
- **Tier B (B1-B3)**: 가장 취약. 비대칭 라우팅 배수 1.003x (B2)는 노이즈 범위 내일 수 있음. 시간적 churn 추세 (B1)는 시드 특정 릴레이-클라이언트 할당에 의해 부분적으로 구동될 수 있음. 1.84x 국가 수준 공격 스파이크 (B3)는 단일 관측.
- **Tier C (C1-C2)**: 영향 없음 (구조적 한계는 결정론적이며 시드 독립적).

**정량적 영향 추정**:
- 약 2%의 상관율과 ~2M 회로에서 이항 샘플링만의 표준 오차는 ~0.01%. 그러나 릴레이 선택, 클라이언트 배치, AS 경로 할당으로부터의 시드 구동 분산은 샘플링 분산보다 수 자릿수 더 클 수 있음.
- 유사 시뮬레이션 연구 기반, 상관율의 변동 계수는 시드 간 일반적으로 5-15%이며, 2.58% 비율이 시드에 따라 ~2.2%에서 ~3.0% 범위일 수 있음을 시사.

**해결 가능?**: **예**. DKW 신뢰구간이 있는 다중 시드 시뮬레이션 (S1: RAPTOR 5시드, S2: Johnson et al. 5시드)이 분산 추정을 제공할 것이다.

---

### G2: 토폴로지 규모 (727 vs ~48,000 AS)

**심각도**: High

**설명**: AS 토폴로지가 727개 AS (최소 하나의 Tor 릴레이를 호스팅하는 AS)와 ~6,200개 edge를 포함하며, RAPTOR의 ~48,000 AS와 ~150,000+ edge 대비. 이 66x AS 수 감소와 24x edge 수 감소는 근본적으로 다음을 제한한다:

1. **경로 다양성**: 모든 AS 쌍 간 대안 경로가 적어 라우팅 변동이 줄고, 비대칭 효과와 churn 노출이 감소.
2. **Transit 체인 길이**: 평균 AS 경로 길이가 2-4 hop (전체 인터넷의 4-7 hop 대비). 짧은 경로는 회로당 transit AS가 적어 관측 기회 감소.
3. **공격 표면**: 단일 대상 AS가 토폴로지의 ~0.14% 차지 (전체 인터넷의 ~0.002% 대비).

**영향받는 주장**:
- **B2 (비대칭 라우팅)**: 1.003x 대 논문 1.66x의 주된 원인. 짧은 경로 (2-4 hop)에서 순방향/역방향 분기 여지가 제한적.
- **C1 (BGP interception)**: ~90% interception 상관 재현 실패는 소규모 토폴로지에서 Tier-1 공격자가 이미 대부분의 경로 위에 있기 때문에 직접적으로 기인.
- **C2 (절대값)**: 모든 절대 상관율이 RAPTOR 값보다 5-50x 낮음.

**해결 가능?**: **부분적**. 완전한 해결에는 수천 AS 토폴로지와 실제 BGP 라우팅 데이터로의 확장이 필요. 그러나 영향은 정량화 가능: 검증 스크립트가 경로 길이 분포와 transit AS 도달 가능성을 계산하여 스케일링 관계를 수립할 수 있다.

---

### G3: BFS 라우팅 모델 (실제 BGP 대비)

**심각도**: High

**설명**: 시뮬레이터가 AS 관계 그래프에서 valley-free 라우팅 제약이 있는 BFS로 AS 경로를 계산한다. 실제 인터넷 라우팅은 복잡한 정책 메커니즘이 있는 BGP를 사용한다:

1. **LOCAL_PREF**: 각 AS가 비즈니스 관계에 기반하여 경로에 선호도를 할당. BFS는 valley-free 제약으로 이를 근사하나 AS별 정책 변동을 포착하지 못함.
2. **AS_PATH 길이**: BGP는 더 짧은 AS 경로를 선택하며, BFS도 구성상 이를 수행. 그러나 실제 BGP는 더 높은 LOCAL_PREF의 더 긴 경로를 선택할 수 있음.
3. **MED**: 인접 AS가 exit 포인트 선택에 영향을 줌. 모델링되지 않음.
4. **Community 속성**: BGP community가 경로 전파에 영향을 주는 라우팅 정책을 인코딩. 모델링되지 않음.
5. **Hot-potato 라우팅**: AS가 가장 가까운 exit 포인트에서 트래픽을 전달하는 것을 선호. 모델링되지 않음.

**영향받는 주장**:
- **B2 (비대칭 라우팅)**: BFS는 *일부* 경로 비대칭을 생성하나, 실제 BGP 비대칭은 각 AS에서의 근본적으로 다른 정책 결정에서 발생하여 훨씬 풍부함. 이것이 1.003x vs 1.66x 격차의 주된 이유.
- **C1 (BGP interception)**: RAPTOR R4의 영향 없음 결과는 부분적으로 BFS가 interception 공지가 BGP 결정 과정을 통해 전파되는 방식을 모델링하지 못하기 때문.

**정량적 영향 추정**:
- BFS/valley-free 라우팅을 실제 BGP 경로와 비교하는 연구는 customer-provider 경로에 ~70-80% 경로 일치를 보이나 peer 경로에는 ~40-50%만 일치. Tor 릴레이 AS의 상당수가 피어링을 통해 연결되므로, 경로 정확도는 교차 AS 회로에 대해 50-60%까지 낮을 수 있음.

**해결 가능?**: **부분적**. 완전한 해결에는 실제 BGP RIB 데이터 (RouteViews 또는 RIPE RIS)의 경로 계산 통합이 필요. 그러나 BFS 한계의 *방향*은 알려져 있으며 일관적: BFS는 경로 다양성과 비대칭을 과소추정한다.

---

### G4: Guard 수명 분포

**심각도**: Medium

**설명**: 시뮬레이터가 균등 분포 U(30, 60)일에서 guard 수명을 할당한다. 실제 Tor 네트워크는 더 복잡한 guard 선택 및 교체 메커니즘을 사용한다:

1. 최소 60일 수명 (최근 Tor 버전에서 120일로 연장)
2. 합의 참여 이력에 기반한 안정성
3. NumEntryGuards = 1 (Tor 0.3.0 이후)

**영향받는 주장**:
- **A1 (릴레이 타협)**: *최종점* (100% 타협)은 정확히 재현되고, 완전 타협률 (9.47%)도 일치. **CDF 형태**만 다름 -- 점진적 S-곡선 대신 계단 함수.

**해결 가능?**: **예**. 시뮬레이션 S3이 가변 guard 수명 (평균 90일 지수분포, 2018년 이후 Tor 동작과 일치)을 사용하여 더 현실적인 CDF를 생성할 것이다.

---

### G5: IXP 미모델링

**심각도**: Medium

**설명**: Internet Exchange Point가 모델링되지 않았다. IXP는 AS 관계 그래프에 포착되지 않는 관측 기회를 생성한다:

1. IXP를 통제하는 엔티티는 해당 위치에서 교환되는 모든 트래픽을 관측 가능
2. IXP의 직접 피어링은 transit 제공자를 우회하는 우회 경로를 생성
3. 주요 IXP (DE-CIX, AMS-IX, LINX)가 Tor 릴레이 운영자를 포함한 수백 AS를 호스팅

**영향받는 주장**:
- **A3 (Tier-1 지배)**: IXP가 Tier-1이 아닌 AS의 위협 순위를 높여 Tier-1 지배 발견을 교란할 수 있음.

**해결 가능?**: **아니오** (데이터 갭). 포괄적 IXP 멤버십과 트래픽 데이터는 공개적으로 이용 불가. RAPTOR와 Johnson et al.도 IXP를 모델링하지 않았으므로, 이는 재현 특정 갭이 아닌 공유된 한계이다.

---

### G6: AS-Level 릴레이 집계

**심각도**: Low

**설명**: 동일 AS 내 모든 Tor 릴레이를 합산 대역폭의 단일 노드로 집계한다. 실제로 동일 AS의 여러 릴레이는 개별 IP 주소, 대역폭, 가동 이력을 가진다.

**영향받는 주장**: 최소. AS-level 집계는 네트워크 레이어 적대자 분석의 표준 추상화 (RAPTOR와 Johnson et al. 모두 이 수준에서 운영).

**해결 가능?**: **아니오** (설계상). AS-level 집계는 AS 경로 관측의 실행 가능한 시뮬레이션을 위한 의도적 모델링 선택이다.

---

### G7: 클라이언트 수 (방어 실험 50명)

**심각도**: Medium

**설명**: 네트워크 방어 비교 실험이 50명의 시뮬레이션 클라이언트만 사용한다. 50명 클라이언트에서:

1. **CDF 세분화**: 각 클라이언트 타협이 CDF에서 2% 점프를 나타내어 부드러운 CDF 대신 계단형 곡선 생성.
2. **희귀 이벤트 민감도**: 매우 적은 클라이언트를 타협시키는 방어 시나리오 (Astoria: 9명, Combined: 5명)는 높은 상대 분산을 가짐.
3. **통계적 검정**: 시나리오 간 타협률 비교 (예: Vanilla vs Counter-RAPTOR 68% vs 68%)에는 작은 차이를 탐지하기 위해 더 큰 표본이 필요.

**영향받는 주장**:
- **A2 (방어 순서)**: Astoria (18%)와 Counter-RAPTOR (68%) 간 큰 격차는 소표본에도 강건. 그러나 Vanilla (68%)와 Counter-RAPTOR (68%)의 차이는 50명 클라이언트로 구별 불가.

**정량적 영향 추정**:
- 68% 실제 타협률의 경우, n=50에서 95% 신뢰구간은 [53.3%, 80.5%] (Wilson 점수). Counter-RAPTOR의 ~4.6% 스트림 수준 감소를 클라이언트 수준에서 탐지하기에 너무 넓음.

**해결 가능?**: **예**. 클라이언트 수를 200+로 증가시키면 95% 수준에서 신뢰구간이 약 +/-6%로 좁아짐.

---

### G8: 시간 해상도 (월간 vs 일간 스냅샷)

**심각도**: Medium

**설명**: CAIDA AS 관계 데이터가 월간 스냅샷 (2025년 1-7월)으로 이용 가능하여, 180일간 7개 토폴로지 상태를 제공한다. RAPTOR는 일간 BGP 라우팅 업데이트를 사용하여 몇 시간 또는 며칠만 지속되는 일시적 라우팅 변화를 포착하였다.

1. **놓친 일시적 경로**: 일간 BGP churn은 경로 변동, 수렴 이벤트, 임시 피어링 변화를 포함하며 일시적 상관 창을 생성. 월간 스냅샷은 이를 완전히 놓침.
2. **평활된 churn**: 월간 스냅샷은 지속적 토폴로지 변화 (>30일 안정한 링크)만 포착.

**영향받는 주장**:
- **B1 (시간적 churn)**: 150일간 ~1.3-1.5x 증가가 논문의 21일간 ~3x 증가를 과소추정. 이 격차의 일부 (토폴로지 규모 이상)는 시간 해상도에 기인.

**해결 가능?**: **부분적**. CAIDA serial-2 데이터셋이 일간 AS 관계 스냅샷을 제공하나, 180개 일간 스냅샷 (7개 월간 대비) 처리는 시뮬레이션 시간을 ~25x 증가시킨다.

---

## 4. 갭 상호작용 매트릭스

일부 갭은 서로 복합된다. 다음 매트릭스는 핵심 상호작용을 식별한다:

| 갭 쌍 | 상호작용 | 복합 효과 |
|--------|---------|----------|
| G1 + G2 | 소규모 토폴로지의 단일 시드 | 미지 분산이 체계적 과소추정을 복합 |
| G2 + G3 | 소규모 토폴로지 + BFS 라우팅 | 경로 다양성 감소가 승법적: 적은 AS AND 덜 현실적 경로 선택 |
| G2 + G5 | 소규모 토폴로지 + IXP 없음 | 누락된 IXP 우회 경로가 이미 작은 그래프의 경로 다양성을 더 감소 |
| G3 + G8 | BFS + 월간 스냅샷 | BFS가 이미 경로 변화를 과소추정; 월간 해상도가 신호를 더 평활화 |
| G1 + G7 | 단일 시드 + 50명 클라이언트 | 양 출처의 분산이 복합: 강건한 CDF를 위해 >5 시드와 >200 클라이언트 필요 |

---

## 5. 해결 우선순위 및 상태

| 우선순위 | 갭 | 해결 방법 | 상태 |
|----------|-----|----------|------|
| 1 | G1 (단일 시드) | S1/S2 다중 시드 시뮬레이션 | 계획됨 |
| 2 | G7 (클라이언트 수) | S2에서 200+로 증가 | 계획됨 |
| 3 | G4 (Guard 수명) | S3 가변 수명 시뮬레이션 | 계획됨 |
| 4 | G2 (토폴로지 규모) | V-스크립트를 통한 스케일링 분석 | 부분적 (정량화) |
| 5 | G3 (BFS 라우팅) | BGP ground truth 대비 경로 정확도 비교 | 부분적 (정량화) |
| 6 | G8 (시간 해상도) | 일간 CAIDA 스냅샷 | 향후 작업 |
| 7 | G5 (IXP) | PeeringDB 통합 | 향후 작업 (데이터 제한) |
| 8 | G6 (릴레이 집계) | 해당 없음 (설계상) | 수용됨 |

---

## 6. 출판 준비 상태에 대한 영향

### 현재 데이터로 출판 준비된 주장:
- **A1, A2, A3**: 큰 효과 크기로 G1 (단일 시드)에도 강건. 다중 시드 확인 (S1/S2)이 강화하겠지만 엄밀히 필요하지는 않음.

### 출판 전 다중 시드 확인이 필요한 주장:
- **B1**: 시간적 추세가 시드 특정 패턴이 아닌지 분산 추정이 필요.
- **B2**: 1.003x 배수가 1.0과 구별 가능한지 분산 추정이 필요.
- **B3**: 1.84x 국가 수준 공격 스파이크는 시드 간 복제가 필요.

### 추가 시뮬레이션으로 강화할 수 없는 주장:
- **C1, C2**: 구조적 한계 (G2, G3)는 근본적 아키텍처 변경 없이 극복 불가. 인정된 한계로 제시해야 함.

---

## 부록: 갭-주장 매핑

| 주장 | G1 | G2 | G3 | G4 | G5 | G6 | G7 | G8 |
|------|----|----|----|----|----|----|----|----|
| A1 (릴레이 타협) | Low | -- | -- | **Med** | -- | Low | -- | -- |
| A2 (방어 순서) | Low | Low | Low | -- | -- | -- | **Med** | -- |
| A3 (Tier-1 지배) | Low | Med | Low | -- | **Med** | -- | -- | -- |
| B1 (시간적 churn) | **High** | **High** | Low | -- | Low | -- | -- | **Med** |
| B2 (비대칭 라우팅) | **High** | **High** | **High** | -- | -- | -- | -- | -- |
| B3 (BGP 공격 영향) | **High** | Med | **High** | -- | -- | -- | Low | -- |
| C1 (Interception ~90%) | -- | **High** | **High** | -- | -- | -- | -- | -- |
| C2 (절대값) | -- | **High** | Med | -- | Med | Low | -- | Med |

*셀 값은 특정 주장에 대한 해당 갭의 영향 심각도를 나타낸다.*
