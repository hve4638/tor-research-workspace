# 타당성 위협

**문서 버전**: 1.0
**날짜**: 2025-02-23
**범위**: AS-level Tor 트래픽 상관 재현 실험에 대한 내적, 외적, 구성, 통계적 결론 타당성 위협의 체계적 분석

---

## 1. 서론

본 문서는 RAPTOR (Sun et al., 2015) 및 Johnson et al. (2013) 논문의 재현에 적용된 표준 4범주 타당성 위협 분류법 (Cook & Campbell, 1979; Wohlin et al., 2012)을 따른다. 각 위협은 결론에 대한 잠재적 영향과 함께 `01_validity_framework.md`의 주장 분류 및 `07_gap_analysis.md`의 갭 분석에 대한 구체적 참조로 평가된다.

---

## 2. 내적 타당성

내적 타당성은 실험에서 관찰된 인과 관계가 진정한 것인지, 또는 혼재 요인이 동일한 결과를 생성할 수 있는지에 관한 것이다.

### 2.1 단일 랜덤 시드

**위협**: 모든 실험이 단일 랜덤 시드를 사용하여 (RAPTOR: 시드 42, Johnson et al.: 기본 시드), 모든 확률적 과정 (클라이언트 배치, 릴레이 선택, 회로 구성, guard 할당)이 랜덤 과정의 단일 실현을 따른다.

**잠재적 영향**: 관찰된 메트릭이 일반적 시스템 행동이 아닌 시드 특정 속성을 반영할 수 있다. 예를 들어:
- 비대칭 라우팅 배수 1.003x (B2)는 시드 42가 생성한 특정 클라이언트-AS 할당의 인공물일 수 있음. 다른 시드는 0.99x 또는 1.05x를 생성할 수 있음.
- 시간적 churn 추세 (B1)는 2025년 1-7월 churn 이벤트의 영향을 받는 AS를 통과하는 시드 특정 guard-클라이언트 쌍에 의해 증폭 또는 감쇠될 수 있음.
- 1.84x 국가 수준 공격 스파이크 (B3)는 시드 42 하에서 어떤 클라이언트의 회로가 AS3320과 AS6939를 통과하는지에 의존.

**영향받는 주장**: 모든 주장, 특히 효과 크기가 시드 간 분산 내일 만큼 작은 Tier B (B1, B2, B3).

**완화**: 다중 시드 시뮬레이션 (S1: RAPTOR 5시드, S2: Johnson et al. 5시드)이 계획됨. 검증 스크립트 V1-V4가 시드별 메트릭을 계산하고 DKW 신뢰구간으로 평균을 보고할 것이다. 큰 효과 크기의 Tier A 주장 (예: Astoria의 99.97% 감소)은 시드 간 강건할 것으로 예상.

### 2.2 결정론적 BFS 라우팅

**위협**: BFS 기반 AS 경로 계산은 고정 토폴로지에서 결정론적이다: 모든 소스-목적지 쌍에 대해 BFS는 항상 동일한 경로를 반환한다. 이는 동일 클라이언트 AS와 exit AS 간의 모든 회로가 토폴로지 스냅샷 내에서 동일한 transit AS를 통과함을 의미한다.

**잠재적 영향**:
- **상관 지속성 과대추정**: 클라이언트-exit 쌍이 한번 상관되면 (또는 되지 않으면), 전체 스냅샷 기간 동안 그대로 유지. 실제 BGP는 경로 변동, 부하 분산, ECMP 등 확률적 요소가 있어 동일 소스-목적지 쌍에서도 일부 회로는 상관되고 다른 회로는 상관되지 않을 수 있음.
- **경로 다양성 과소추정**: BFS는 단일 최단 경로를 반환하나, 실제 BGP는 여러 거의 동등한 경로에 트래픽을 분배할 수 있음 (ECMP).

**영향받는 주장**: B1 (시간적 churn이 점진적보다 계단형으로 보일 수 있음), B2 (비대칭 효과가 확률적이 아닌 AS 쌍별 이진적).

**완화**: BFS의 결정론적 특성은 확률적 릴레이 선택 과정에 의해 부분적으로 상쇄된다: 다른 회로가 다른 guard/middle/exit 릴레이 (따라서 다른 AS 쌍)를 선택하여, 개별 AS 쌍 경로가 고정되어도 회로 간 경로 다양성을 제공한다.

### 2.3 단순화된 Guard 선택 모델

**위협**: Guard 선택 모델이 대역폭 가중치 랜덤 선택과 U(30, 60)일에서 추출한 고정 수명을 사용한다. 실제 Tor guard 선택 (2018년 이후)은 다음을 포함한다:
- 최소 120일 수명의 주 guard
- 주 guard 실패 시 보조 guard로 전환
- 합의 참여 이력에 기반한 guard 안정성

**잠재적 영향**:
- **CDF 형태 왜곡**: 57-60일의 계단 함수 (A1)가 원 논문의 점진적 S-곡선과 다름. 이는 첫 타협 이벤트의 시간 분포에 영향을 미치지만 최종점 (100% 최종 타협)에는 영향을 미치지 않음.

**영향받는 주장**: A1 (CDF 형태만, 최종 타협률은 아님).

**완화**: 시뮬레이션 S3이 가변 guard 수명 (평균 90일 지수분포)을 사용할 것이다. 최종점 결과 (100% 타협, 9.47% 회로 타협)는 이 위협에 영향받지 않음.

### 2.4 회로 구성 독립성

**위협**: 시뮬레이터가 회로를 독립적으로 구성한다: 각 회로의 guard/middle/exit 선택이 다른 모든 회로와 독립적. 실제 Tor는 회로 간 guard를 재사용하고 회로 재사용 정책이 있다.

**잠재적 영향**: 회로 수준 상관율이 타협 이벤트의 독립성을 약간 과대추정할 수 있음. 클라이언트의 guard가 타협되면, 해당 guard를 사용하는 모든 회로가 동시에 타협되어 독립 이벤트가 아닌 상관 이벤트를 생성.

**영향받는 주장**: 집계 비율 (A2, B1)에 최소 영향; 클라이언트별 시간 패턴에 영향.

**완화**: 시뮬레이터는 guard 수명 창 내에서 guard 지속성을 모델링한다. max_dirtiness 매개변수는 Tor 기본값과 일치하는 600초로 설정. 주요 독립성 가정은 middle/exit 선택에 있으며, 이는 Tor의 실제 동작과 일치.

---

## 3. 외적 타당성

외적 타당성은 발견이 특정 실험 설정을 넘어 일반화되는지에 관한 것이다.

### 3.1 축소된 토폴로지 규모

**위협**: 727-AS Tor 관련 서브그래프가 RAPTOR가 사용한 전체 인터넷 AS 토폴로지 (~48,000 AS)보다 66x 작다. 외적 타당성에 대한 가장 중요한 위협이다.

**잠재적 영향**:
- **경로 길이 감소**: 평균 AS 경로 길이가 4-7 hop (전체 인터넷)에서 2-4 hop (본 그래프)로 감소하여, transit AS 관측 기회가 약 40-60% 감소.
- **Transit 다양성 손실**: ~6,200 edge 대 ~150,000+로, 대안 경로가 적음. 본 토폴로지에서 60% 경로에 나타나는 transit AS가 전체 인터넷에서는 10%에만 나타날 수 있어, 관측 능력의 분포가 근본적으로 변화.
- **공격 표면 압축**: 단일 AS를 대상으로 하는 BGP 공격이 소규모 토폴로지에 비례적으로 더 많은 영향 (대상당 0.14% 대 전체 인터넷 0.002%).

**영향받는 주장**: C1 (interception 미재현), C2 (절대값 5-50x 낮음), B2 (비대칭 라우팅 크기 불충분).

**완화**:
1. 모든 주장을 절대값이 아닌 상대적 비교로 프레이밍.
2. 검증 스크립트가 경로 길이 분포와 transit AS 도달 가능성을 정량화하여 스케일링 관계 수립.
3. Johnson et al. 기준선의 근접 일치 (~2% 논문 vs 1.93% 본 실험)는 토폴로지 내 비교에서 결과가 유효함을 시사.

### 3.2 IXP 레이어 누락

**위협**: Internet Exchange Point가 모델링되지 않았다. IXP는 다음을 제공한다:
- IXP 운영자에 대한 직접 관측 능력 (일부 지역에서 Tier-1 transit AS에 필적)
- Transit 제공자를 우회하는 우회 경로
- 인터넷 상호연결의 증가하는 비중 (특히 Tor 릴레이가 집중된 유럽)

**잠재적 영향**:
- **위협 순위 왜곡**: DE-CIX, AMS-IX, LINX 등 주요 IXP가 Tor 릴레이를 호스팅하는 수백 AS를 연결. IXP 운영자는 일부 Tier-1 transit 제공자보다 더 많은 Tor 트래픽을 관측할 수 있어, Tier-1 지배 발견 (A3)을 교란할 수 있음.
- **방어 효과 변화**: Astoria의 방어는 IXP 관측을 고려하지 않음. IXP 관측이 유의하다면, Astoria의 효과가 과대추정될 수 있음.

**영향받는 주장**: A3 (IXP 레이어 없이 Tier-1 지배가 불완전할 수 있음), A2 (Astoria 효과 과대추정 가능).

**완화**: RAPTOR와 Johnson et al. 모두 IXP를 모델링하지 않았으므로, 이는 재현 특정 갭이 아닌 공유된 한계이다.

### 3.3 AS-Level 집계

**위협**: 동일 AS 내 모든 Tor 릴레이가 단일 노드로 집계된다. 이는 AS 내 다양성 (다른 데이터센터의 릴레이), 운영자 다양성, 대역폭 이질성을 은폐한다.

**영향받는 주장**: 최소. AS-level 집계는 양 원 논문과 공유되는 표준 추상화이다.

**완화**: 양 원 논문과 공유되는 의도적 설계 선택이다.

### 3.4 토폴로지 빈티지 (2025 vs 2013-2014)

**위협**: CAIDA 데이터가 2025년을 포괄하고, 원 논문은 2013-2014 데이터를 사용하였다. 인터넷 AS-level 토폴로지가 진화하였다:
- AS 연결 패턴 변화 (HE 피어링 확장, NTT 상대적 역할 감소)
- Tor 릴레이 지리적 분포가 유럽 호스팅 제공자로 이동
- 새로운 대형 호스팅 AS 등장 (Hetzner, OVH 성장)

**영향받는 주장**: A3 (특정 순위 위치가 논문과 다르나, 범주적 Tier-1 지배는 보존).

**완화**: 빈티지 차이가 명시적으로 문서화됨. 본 결과는 2013년 시대 결과와 비교하여 AS-level 위협의 시간적 추세를 식별할 수 있는 2025년 시대 스냅샷을 나타낸다.

---

## 4. 구성 타당성

구성 타당성은 측정이 측정하고자 하는 이론적 구성을 실제로 포착하는지에 관한 것이다.

### 4.1 상관 탐지를 역익명화 대용으로 사용

**위협**: "트래픽 상관" 메트릭이 동일 AS가 entry 경로 (클라이언트-guard)와 exit 경로 (exit-목적지) 양쪽에 나타나는 회로를 카운트한다. 이는 실제 트래픽 역익명화의 필요 조건이지만 충분 조건은 아니다:

1. **타이밍 분석 갭**: AS가 entry와 exit 트래픽을 모두 관측하더라도, 성공적 역익명화에는 타이밍 상관 (패킷 도착/출발 패턴 매칭)이 필요. 타이밍 분석은 모델링하지 않음.
2. **트래픽 볼륨 요구**: 저볼륨 트래픽이 고볼륨보다 상관하기 어려울 수 있음. 모든 상관 회로가 동등하게 취약하다고 가정.
3. **암호화 레이어**: Tor의 레이어드 암호화는 관측 AS가 암호화된 트래픽을 봄을 의미. 트래픽 분석이 종종 이를 극복할 수 있으나 보장되지 않음.

**잠재적 영향**: 상관율이 실제 역익명화 능력의 **상한**을 나타냄. 이는 동일 메트릭을 사용하는 RAPTOR 및 Johnson et al.과 일관적.

**완화**: 양 원 논문과 공유되는 연구 방법론의 내재적 위협. 결과를 "성공적 역익명화"가 아닌 "상관 기회"를 측정하는 것으로 명시적으로 프레이밍.

### 4.2 정적 적대자 모델

**위협**: 적대자 모델이 정적 적대자 배치를 가정한다:
- 네트워크 적대자: 시뮬레이션 시작 시 결정되는 고정된 관측 능력의 AS 집합
- 릴레이 적대자: 고정된 적대자 릴레이 구성, 적응적 행동 없음

**잠재적 영향**: 실제 적대자는 동적으로 릴레이 대역폭을 조정하고, guard 교체 창을 이용하고, 관찰된 트래픽 패턴에 기반하여 표적 BGP 공격을 시작하여 특정 사용자를 **적응적으로 대상**으로 할 수 있음.

**영향받는 주장**: 모든 주장이 적응적 적대자의 위협을 과소추정할 수 있음. 그러나 정적 적대자 모델은 원 논문의 표준 가정.

**완화**: 원 논문의 위협 모델과 일관적. 결과가 적응적 적대자 능력의 **하한**을 제공.

### 4.3 균등 클라이언트-목적지 분포

**위협**: 시뮬레이션 클라이언트가 모든 exit 도달 가능 AS에서 균등 무작위로 목적지를 선택한다. 실제 Tor 사용은 높은 편향된 목적지 분포를 가진다:
- 인기 웹사이트 (Google, Facebook)가 특정 AS로 트래픽을 집중
- 지리적으로 편향된 트래픽 패턴
- 다른 사용 프로파일 (웹 브라우징 vs 메시징 vs 파일 공유)

**잠재적 영향**: 많은 클라이언트가 동일한 인기 목적지에 접근하면, 적대자가 상관 이점을 얻음. exit 측 AS 경로가 많은 회로에서 공유되어 동일 transit AS가 여러 클라이언트의 트래픽을 관측할 확률이 증가.

**영향받는 주장**: B1, B3 (시간적 및 공격 효과가 목적지 집중에 따라 강해지거나 약해질 수 있음), A2 (방어 효과가 목적지 분포에 따라 변할 수 있음).

**완화**: 균등 분포가 보수적 기준선을 제공. 현실적 트래픽 모델 (예: Alexa Top-1000 목적지 가중치)로의 검증은 향후 작업.

---

## 5. 통계적 결론 타당성

통계적 결론 타당성은 통계적 방법과 표본 크기가 도출된 결론을 지지하는지에 관한 것이다.

### 5.1 표본 크기: 50-클라이언트 방어 실험

**위협**: 네트워크 방어 비교 (Johnson et al. Set A)가 50명의 시뮬레이션 클라이언트만 사용한다.

**잠재적 영향**:
- **넓은 신뢰구간**: 68% 타협률의 경우, Wilson 95% CI는 [53.3%, 80.5%]. 18% 비율 (Astoria)의 경우, CI는 [8.6%, 31.4%].
- **구별 불가 시나리오**: Vanilla와 Counter-RAPTOR 모두 68% 클라이언트 타협 (34/50)을 보임. n=50에서 Counter-RAPTOR가 클라이언트 수준 이점을 제공하는지 판단 불가.

**영향받는 주장**: A2 (클라이언트 수준에서 Vanilla vs Counter-RAPTOR 비교가 통계적으로 불확정).

**완화**:
1. 스트림 수준 비교 (1.93% vs 1.84%, 1,944,150 회로 기반)가 훨씬 높은 통계적 검정력을 제공하며 Counter-RAPTOR의 완만한 효과를 확인.
2. Astoria vs Vanilla 격차 (18% vs 68%)는 n=50에서도 고도로 유의 (Fisher 정확 검정 p < 0.001).
3. 계획된 S2 시뮬레이션이 클라이언트 수를 200+로 증가시킬 것이다.

### 5.2 관측 기간: 90-180일

**위협**: 실험이 90일 (RAPTOR R1, R3, R4) 또는 180일 (RAPTOR R2, 릴레이 적대자)에 걸친다.

**잠재적 영향**:
- **Guard 교체 범위**: U(30, 60) guard 수명에서 90일은 1.5-3회 교체만 포괄. 릴레이 적대자 실험 (180일)은 교체 주기를 적절히 포괄하나, 90일 RAPTOR 실험은 두 번째 교체 효과를 포착하지 못할 수 있음.
- **계절적 BGP 패턴**: 인터넷 라우팅은 계절적 패턴을 보임. 90-180일 창이 연간 패턴을 대표하지 못할 수 있음.

**영향받는 주장**: B1 (6개월 이상의 추세 외삽은 추정적).

**완화**: 시간적 실험의 180일 창은 RAPTOR의 90일 창과 비슷함. 100% 릴레이 타협이 60일까지 발생하므로 릴레이 적대자 실험은 적절한 범위를 가짐 (180일 >> 60일).

### 5.3 다중 비교

**위협**: 동일 실험 데이터에서 다중 주장 (A1-A3, B1-B3, C1-C2)을 다중 검정 보정 없이 평가한다.

**잠재적 영향**: 8개 주장이 평가되면, 최소 하나가 우연히 "통과"할 확률은 (alpha = 0.05에서) 약 1 - (1-0.05)^8 = 33.7%. 그러나 주장들은 독립적 가설 검정이 아닌 다른 메트릭의 정성적 평가이다.

**영향받는 주장**: 전체이나, 위험은 낮음:
1. Tier A 주장은 합리적 alpha 임계값을 훨씬 넘는 매우 큰 효과 크기를 가짐
2. Tier B 주장은 명시적으로 조건부로 레이블됨
3. Tier C 주장은 통계적 추론이 아닌 구조적 한계

**완화**: alpha 임계값이 있는 공식적 가설 검정을 수행하지 않음. 대신 효과 크기 규모를 고려하는 정성적 등급 시스템을 사용.

### 5.4 회로의 비독립성

**위협**: 동일 클라이언트의 회로가 동일 guard 릴레이를 공유하여 (guard 수명 내) 상관된 결과를 생성. 모든 회로를 독립적으로 취급하면 (이항 신뢰구간 계산 시) 통계적 정밀도를 과대추정.

**잠재적 영향**:
- 상관율 추정의 유효 표본 크기가 원시 회로 수보다 작음. 200명 클라이언트가 각각 38,880 회로를 생성하고 (90일 * 432 회로/일), 클라이언트 내 회로가 공유 guard로 상관되면, 유효 표본 크기는 7,776,600 (회로 수)보다 200 (클라이언트 수)에 더 가까울 수 있음.
- 이는 작은 차이의 외견상 통계적 유의성을 부풀림 (예: 2.577% vs 2.584% 비대칭 라우팅 비교).

**영향받는 주장**: B2 (1.003x 배수가 클라이언트 내 상관을 고려하면 1.0과 구별 불가능할 수 있음).

**완화**:
1. 검증 스크립트가 클라이언트별 상관율을 계산하고 클라이언트 수준 평균과 표준 오차를 보고해야 함 (실험당 n = 200 또는 500 독립 관측).
2. 다중 시드 실행이 실험 내 회로 이상의 추가 독립 표본을 제공.

---

## 6. 위협 및 완화 요약

| # | 위협 | 범주 | 심각도 | 영향받는 주장 | 완화 |
|---|------|------|--------|-------------|------|
| 2.1 | 단일 랜덤 시드 | 내적 | Critical | 전체 (특히 B1-B3) | S1/S2 다중 시드 |
| 2.2 | 결정론적 BFS 라우팅 | 내적 | High | B1, B2 | 확률적 릴레이 선택이 다양성 제공 |
| 2.3 | 단순화된 guard 모델 | 내적 | Medium | A1 (CDF 형태) | S3 가변 수명 |
| 2.4 | 회로 독립성 | 내적 | Low | 집계 비율 | Guard 지속성 모델링됨 |
| 3.1 | 축소된 토폴로지 (727 vs 48K) | 외적 | High | C1, C2, B2 | 상대적 주장만; 스케일링 분석 |
| 3.2 | IXP 레이어 누락 | 외적 | Medium | A3 | 원 논문과 공유된 한계 |
| 3.3 | AS-level 집계 | 외적 | Low | 최소 | 논문과 공유된 설계 선택 |
| 3.4 | 토폴로지 빈티지 (2025 vs 2013) | 외적 | Low | A3 순위 | 시간적 이동 명시적 문서화 |
| 4.1 | 상관을 역익명화 대용으로 사용 | 구성 | Medium | 전체 (상한) | 문헌의 표준 메트릭 |
| 4.2 | 정적 적대자 모델 | 구성 | Medium | 전체 (하한) | 논문의 표준 가정 |
| 4.3 | 균등 목적지 분포 | 구성 | Low | B1, B3, A2 | 보수적 기준선 |
| 5.1 | 50-클라이언트 방어 실험 | 통계 | Medium | A2 (CR vs Vanilla) | S2 200+ 클라이언트 |
| 5.2 | 90-180일 관측 기간 | 통계 | Low | B1 추세 외삽 | 주요 발견에 적절 |
| 5.3 | 다중 비교 | 통계 | Low | 전체 | 정성적 등급 시스템 |
| 5.4 | 비독립적 회로 | 통계 | Medium | B2 | V-스크립트의 클라이언트별 집계 |

---

## 7. 전체 타당성 평가

### 결론을 무효화하지 않는 위협:
- **내적**: 결정론적 BFS (2.2), 단순화된 guard 모델 (2.3), 회로 독립성 (2.4)은 결과의 특정 측면에 영향을 미치나 주요 주장 분류를 무효화하지 않음.
- **외적**: AS-level 집계 (3.3)와 토폴로지 빈티지 (3.4)는 저심각도 위협. IXP 누락 (3.2)은 원 논문과 공유된 한계.
- **구성**: 양 구성 위협 (4.1, 4.2)이 알려진 방향으로 결과를 경계함 (기회 과대추정, 적응적 적대자 과소추정).
- **통계**: 관측 기간 (5.2)과 다중 비교 (5.3)는 실험 설계로 적절히 처리됨.

### 출판 전 완화가 필요한 위협:
1. **단일 시드 (2.1)**: Critical. 신뢰구간이 있는 다중 시드 시뮬레이션으로 해결해야 함.
2. **50-클라이언트 실험 (5.1)**: 클라이언트 수준에서 Counter-RAPTOR와 Vanilla를 구별하기 위해 처리해야 함.
3. **비독립적 회로 (5.4)**: 분석 스크립트의 클라이언트별 집계로 처리해야 함.

### 인정된 한계인 위협:
1. **토폴로지 규모 (3.1)**: 아키텍처 변경 없이 완전히 해결 불가. 모든 주장을 상대적 비교로 프레이밍하여 완화.
2. **BFS 라우팅 (2.2)**: BGP RIB 통합 없이 완전히 해결 불가. 편향의 방향이 알려져 있고 문서화됨.

### 순 평가:
Tier A 주장 (릴레이 타협 메커니즘, 방어 순서, Tier-1 지배)은 모든 식별된 위협에 **강건**하다. Tier B 주장 (시간적 churn, 비대칭 라우팅, BGP 공격 영향)은 다중 시드 확인이 필요하나 방향적으로 올바르다. Tier C 한계 (interception 비효과, 절대값 격차)는 현재 아키텍처의 추가 시뮬레이션으로 해결할 수 없는 구조적 제약으로 적절히 분류되어 있다.
