# 타당성 프레임워크: AS-Level Tor 트래픽 분석 주장 분류

**문서 버전**: 1.0
**날짜**: 2025-02-23
**범위**: RAPTOR 및 Johnson et al. 재현 실험에서 도출된 주장을 재현 품질과 구조적 한계에 따라 3단계로 분류

---

## 1. 서론

본 문서는 AS-level Tor 트래픽 상관 시뮬레이터에서 도출된 주장의 타당성을 체계적으로 평가하기 위한 프레임워크를 수립한다. 시뮬레이터는 두 기초 논문의 결과를 재현한다:

- **RAPTOR** (Sun et al., USENIX Security 2015): 비대칭 라우팅, BGP churn, 엔티티 위협 순위, BGP interception 공격을 통한 AS-level 트래픽 상관
- **Johnson et al.** (ACM CCS 2013): 릴레이 수준 및 네트워크 수준 적대자 모델, 방어 메커니즘 평가 (Counter-RAPTOR, Astoria)

재현은 **727개 AS Tor 관련 서브그래프** (원 논문의 ~48,000개 전체 인터넷 AS 토폴로지 대비), **BFS 기반 valley-free 라우팅** (실제 BGP RIB 데이터 대비), **CAIDA 2025 관계 데이터셋** (2013-2014 스냅샷 대비)을 사용한다. 이러한 구조적 차이로 인해 어떤 주장을 강하게, 조건부로, 또는 전혀 할 수 없는지 신중한 분류가 필요하다.

### 1.1 분류 방법론

주장은 다음 기준에 따라 3단계로 분류된다:

1. **정량적 정확성**: 절대 수치가 원 논문과 합리적 범위 내에서 일치하는지
2. **정성적 일관성**: 상대적 순서, 추세, 방향성 효과가 보존되는지
3. **구조적 독립성**: 주장이 토폴로지 규모, 라우팅 모델 충실도 등 재현과 원본 간 차이 요인에 의존하는지

### 1.2 데이터 출처

본 문서에 인용된 모든 수치는 다음 실험 보고서에서 추출하였다:

| 보고서 | 경로 | 회로 수 |
|--------|------|---------|
| RAPTOR 재현 | `.experiments/raptor/results/raptor_reproduction_report.json` | 총 ~56M |
| 네트워크 방어 비교 | `.experiments/users_get_routed/results/network_defense_comparison_report.json` | 시나리오당 1,944,150 |
| 릴레이 적대자 | `.experiments/users_get_routed/results/relay_adversary_report.json` | 15,552,600 |

---

## 2. Tier A: 강한 주장 (정량적 재현)

Tier A 주장은 실험 결과가 원 논문의 발견과 정량적으로 일치하는 것이다. 이 주장들은 인터넷 규모 라우팅 세부사항이 아닌 Tor 프로토콜의 구조적 속성에 의존하므로 **토폴로지 규모에 강건**하다.

### A1. 릴레이 적대자 타협 메커니즘

**주장**: 고대역폭 guard 및 exit 릴레이를 운영하는 릴레이 수준 적대자는 guard 교체 기간 내에 100% 클라이언트 타협을 달성한다.

**근거**:
- 200/200 클라이언트 (100%)가 60.0일까지 타협됨 (릴레이 적대자 보고서: `relay_cdf.vanilla`)
- 첫 타협: 57.1일; 50% 타협: 59.7일
- 57-60일의 계단 함수 CDF는 guard 수명 상한 (30-60일 균등 분포)과 정확히 일치
- Exit 전용 지배: 회로의 90.5% (14,078,731 / 15,552,600)에서 적대자 exit 선택
- 완전 guard+exit 타협: 회로의 9.47% (1,472,947 / 15,552,600)
- Guard 전용 이벤트: 15,552,600 회로 중 107건만 발생

**논문 비교** (Johnson et al. Figure 2b/c):
- Exit 전용 지배 (~90%): **재현됨** (90.5%)
- Guard 전용 희귀: **재현됨** (107건)
- 완전 타협률 (~10%): **재현됨** (9.47%)
- 스트림 타협 비율 (~10%): **재현됨** (9.47%)

**Tier A인 이유**: 이 결과는 Tor의 릴레이 선택 알고리즘 (대역폭 가중치 샘플링)과 guard 교체 메커니즘에 의존하며, AS-level 토폴로지에는 의존하지 않는다. 727-AS 한계는 릴레이 수준 적대자 모델링에 영향을 주지 않는다.

**타당성 상태**: **강함**. 모든 릴레이 적대자 메트릭에서 논문 값과 1% 이내 정량적 일치.

---

### A2. 방어 효과 순서

**주장**: Astoria는 Counter-RAPTOR보다 AS-level 트래픽 상관에 대해 극적으로 강한 방어를 제공하며, 두 방어의 조합이 가장 강력한 보호를 제공한다.

**근거** (네트워크 방어 비교 보고서: `overall`):

| 시나리오 | 상관율 | 스트림 감소율 | 클라이언트 타협 | 클라이언트 감소율 |
|----------|--------|-------------|----------------|------------------|
| Vanilla (기준선) | 1.93% | -- | 34/50 (68.0%) | -- |
| Counter-RAPTOR | 1.84% | -4.6% | 34/50 (68.0%) | 0.0% |
| Astoria | 0.0006% | -99.97% | 9/50 (18.0%) | -73.5% |
| Combined (CR + Astoria) | 0.0003% | -99.99% | 5/50 (10.0%) | -85.3% |

**논문 비교** (Johnson et al. Figure 3, Nithyanand et al.):
- 네트워크 기준선 ~2%: **재현됨** (1.93%)
- Astoria 극적 감소: **재현됨** (-99.97% 스트림)
- Counter-RAPTOR 완만한 개선: **재현됨** (-4.6% 스트림)

**순서 보존**: Combined > Astoria >> Counter-RAPTOR > Vanilla (방어 품질 기준)

**Tier A인 이유**: Astoria의 메커니즘 (entry/exit transit AS 중첩 회피)은 *상대적* 효과에서 토폴로지 독립적이다. Astoria와 Counter-RAPTOR 간 3-4 자릿수 차이는 스케일링 효과에서도 유지될 만큼 크다.

**시간적 안정성** (네트워크 방어 비교 보고서: `trends`):
- Vanilla와 Counter-RAPTOR는 증가 추세 (기울기 +0.0031, +0.0026/기간)
- Astoria와 Combined는 안정적 (기울기 ~10^-9, 사실상 제로)
- Astoria 방어가 시간적 라우팅 변화에도 강건함을 확인

**타당성 상태**: **강함**. Astoria와 Counter-RAPTOR 간 >99.9% 감소 격차로 방어 순서가 결정적으로 확립됨.

---

### A3. Tier-1 AS 관측 지배

**주장**: Tier-1 transit AS가 AS-level 트래픽 상관에서 위협 환경을 지배한다.

**근거** (RAPTOR 재현 보고서: `R3_entity_threat`):

| 순위 | ASN | 이름 | 위협 점수 | Tier-1? | RAPTOR 순위 |
|------|-----|------|----------|---------|-------------|
| 1 | AS6939 | Hurricane Electric | 1.247% | 예 | 5 |
| 2 | AS174 | Cogent | 0.864% | 예 | 4 |
| 3 | AS1299 | Telia | 0.259% | 예 | 3 |
| 6 | AS3356 | Level3/Lumen | 0.095% | 예 | 2 |

- RAPTOR 논문의 식별 가능한 Tier-1 AS **4개 중 4개**가 top-6에 등장
- Top-3가 모두 Tier-1 transit 제공자
- 727개 AS 중 82개 (11.3%)가 0 이상의 위협 점수를 보유하나, top-3 Tier-1 AS가 총 상관 능력의 불균형적 비중을 차지

**Tier A인 이유**: 주장이 절대값이 아닌 *상대적 지배*에 관한 것이다. Tier-1 AS는 모든 AS 토폴로지 표현에서 transit 제공자로서 구조적으로 위치한다. 10년의 토폴로지 변화와 66배 규모 차이에도 순위 안정성 (특히 Telia #3)이 유지되어 이 발견의 구조적 특성이 강화된다.

**타당성 상태**: **강함**. Tier-1 지배는 토폴로지 규모와 시대를 넘어 지속되는 인터넷 라우팅의 구조적 속성이다.

---

## 3. Tier B: 조건부 주장 (정성적 재현, 단서 필요)

Tier B 주장은 원 논문의 *방향적 추세*를 재현하지만 크기가 상당히 다른 경우이다. 토폴로지 규모, 라우팅 모델, 시간 해상도에 대한 명시적 단서가 필요하다.

### B1. 시간적 변동이 상관을 증가시킴 (BGP Churn 효과)

**주장 (조건부)**: BGP 라우팅 변화가 시간에 따라 AS-level 트래픽 상관율을 증가시키지만, 증가 크기는 토폴로지 규모에 의존적이다.

**근거** (RAPTOR 재현 보고서: `R2_temporal_churn`):

대칭 라우팅 곡선 (기간 0-5):
| 기간 | 월 | 상관율 | 누적 배수 |
|------|-----|--------|----------|
| 0 | 2025-01 | 2.04% | 1.00x |
| 1 | 2025-02 | 2.31% | 1.13x |
| 2 | 2025-03 | 3.05% | 1.50x |
| 3 | 2025-04 | 2.87% | 1.41x |
| 4 | 2025-05 | 3.15% | 1.55x |
| 5 | 2025-06 | 3.06% | 1.50x |

**정성적 일치**: 양 곡선에서 전반적 상승 추세 확인. 대칭: 2.04%에서 3.15% (1.55x). 비대칭: 2.58%에서 3.29% (1.28x).

**정량적 격차**: RAPTOR는 21일간 ~3x 증가를 보고; 본 실험은 150일간 ~1.3-1.5x 관찰 (~2x 추세 규모 과소추정).

**필요한 단서**:
1. **시간 해상도**: 월간 CAIDA 스냅샷 (30일 간격) 사용; RAPTOR는 일간 BGP 업데이트로 일시적 라우팅 변화를 포착. 일간 세분화는 churn 효과를 증폭시킬 것이다.
2. **토폴로지 규모**: 727 AS에서는 대안 라우팅 경로가 적어, 각 churn 이벤트가 영향을 미치는 회로가 적다.
3. **비단조성**: 기간 1 (비대칭)에서 감소 (2.58%에서 2.27%)가 나타나, churn이 상관 기회를 *제거*할 수도 있음을 시사.

**타당성 상태**: **조건부**. 정성적 추세가 재현됨; 크기 격차 (~2x)는 정량화 가능한 구조적 차이에 기인.

---

### B2. 비대칭 라우팅이 상관 기회를 증가시킴

**주장 (조건부)**: 비대칭 인터넷 라우팅 (순방향 경로 != 역방향 경로)을 고려하면 AS-level 관측 기회 집합이 증가하지만, 이 증가의 크기는 토폴로지 규모와 라우팅 모델 충실도에 강하게 의존한다.

**근거** (RAPTOR 재현 보고서: `R1_asymmetric_routing`):

| 메트릭 | 대칭 | 비대칭 | 배수 |
|--------|------|--------|------|
| 상관율 | 2.577% | 2.584% | 1.003x |
| 상관 회로 | 200,409 | 200,922 | -- |
| 총 회로 | 7,776,600 | 7,776,600 | -- |

**논문 비교**: RAPTOR는 1.66x (12.8%에서 21.3%)를 보고.

**방향 보존**: `asym_rate >= sym_rate` 관계 유지 (2.584% >= 2.577%), 그러나 1.003x 배수는 단일 시드로는 통계적 의미가 불충분.

**타당성 상태**: **조건부**. 방향성 효과 (asym >= sym)가 보존되나, 1.003x 배수 대 논문의 1.66x는 토폴로지 규모 의존성에 대한 강한 단서가 필요.

---

### B3. BGP 공격이 상관에 미치는 영향 (네트워크 적대자)

**주장 (조건부)**: BGP 공격 (hijack, interception, 국가 수준)은 AS-level 트래픽 상관을 높일 수 있으나, 크기는 토폴로지 규모 대비 공격 범위에 의존한다.

**근거** (네트워크 방어 비교 보고서: `attack_impact`):

| 공격 | 유형 | 공격자 -> 대상 | Pre 상관율 | During 상관율 | Post 상관율 | During/Pre |
|------|------|---------------|-----------|-------------|-----------|------------|
| 0 | hijack | AS174 -> AS24940 | 1.84% | 1.66% | 1.95% | 0.90x |
| 1 | interception | AS3356 -> AS60729 | 1.74% | 1.95% | 2.13% | 1.12x |
| 2 | state hijack | AS3320 -> AS6939 | 1.74% | 3.20% | 2.29% | **1.84x** |

**주목할 발견**: 공격 2 (국가 수준 AS3320이 Hurricane Electric AS6939를 hijack)가 가장 큰 공격 중 스파이크: 3.20%, 공격 전 대비 1.84x. 이는 주요 transit AS를 통제하는 국가 수준 적대자가 가장 큰 위협이라는 논문의 발견과 일치.

**타당성 상태**: **조건부**. 국가 수준 공격이 명확한 상관 스파이크 (1.84x)를 보이지만, 다중 시드 확인과 토폴로지 규모 제한이 존재.

---

## 4. Tier C: 주장 불가 (구조적 한계)

Tier C는 원 논문과의 근본적 구조적 차이로 인해 실험 설정이 **지원할 수 없는** 주장을 포함한다. 구현 오류가 아닌 축소 규모 재현 접근법의 내재적 한계이다.

### C1. BGP Interception 공격 효과 (RAPTOR R4)

**주장 불가**: 본 실험은 BGP interception 공격이 상관을 ~90%까지 증가시킨다는 RAPTOR 논문의 발견을 재현할 수 없다.

**근거** (RAPTOR 재현 보고서: `R4_interception`):

| 메트릭 | RAPTOR 논문 | 본 실험 결과 |
|--------|------------|-------------|
| 기준선 | ~12.8% (비대칭) | 2.58% |
| Interception 중 | ~90% | 2.55% |
| 변화 | ~7x 증가 | -1.4% (증가 없음) |

**구조적 이유**:
1. **토폴로지 규모**: 727-AS 그래프에서 Tier-1 공격자는 이미 대부분의 transit 경로 위에 있다. Interception이 추가하는 관측 능력은 미미하다.
2. **단일 대상 공격**: 각 공격이 하나의 AS prefix만 대상. 727 AS에서 각 대상은 토폴로지의 ~0.14%를 차지.
3. **BFS 라우팅 한계**: BFS 기반 라우팅은 BGP 경로 선호 메커니즘 (LOCAL_PREF, AS_PATH 길이, MED)을 완전히 모델링하지 못한다.

**타당성 상태**: **주장 불가**. 구조적 한계이며 구현 오류가 아님.

---

### C2. 절대 상관율 값

**주장 불가**: 시뮬레이터가 생성하는 상관율은 원 논문 값보다 5-50배 낮다.

**절대값 비교**:

| 메트릭 | 논문 값 | 본 실험 값 | 비율 |
|--------|---------|-----------|------|
| RAPTOR R1 대칭 | 12.8% | 2.58% | 5.0x 낮음 |
| RAPTOR R1 비대칭 | 21.3% | 2.58% | 8.3x 낮음 |
| RAPTOR R3 최대 위협 (NTT) | 91% | 1.25% (HE) | 72.8x 낮음 |
| Johnson et al. 네트워크 기준선 | ~2% | 1.93% | ~1.0x (일치) |

**참고**: Johnson et al. 기준선 (~2%)은 본 실험 결과 (1.93%)와 근접하게 일치하여, 유사한 토폴로지 규모에서의 *논문 내* 비교는 유효함을 시사한다.

**격차의 구조적 원인**:

| 요인 | RAPTOR | 본 재현 | 영향 |
|------|--------|--------|------|
| AS 수 | ~48,000 | 727 | Transit 경로 다양성 66x 감소 |
| Edge 수 | ~150,000+ | ~6,200 | 경로 대안 24x 감소 |
| 경로 길이 | 일반적 4-7 hop | 일반적 2-4 hop | Transit AS 관측 기회 감소 |
| 라우팅 모델 | 실제 BGP RIB | BFS + Gao-Rexford | 덜 현실적인 경로 선택 |

**타당성 상태**: **주장 불가**. 모든 주장은 절대 상관율이 아닌 *상대적 비교* (방어 감소율, 추세 방향, 순위 순서)로 프레이밍해야 한다.

---

## 5. 교차 타당성 고려사항

### 5.1 단일 시드 한계

현재 모든 결과는 시드 42 (RAPTOR) 또는 기본 시드 (Johnson et al.)를 사용한다. 신뢰구간이 있는 다중 시드 실행 없이는 개별 수치의 분산을 알 수 없다.

- **Tier A 주장**: 큰 효과 크기로 강건 (예: Astoria의 99.97% 감소는 시드 인공물일 가능성이 낮음)
- **Tier B 주장**: 더 민감; 비대칭 라우팅 배수 1.003x는 노이즈 범위 내일 수 있음
- **Tier C 주장**: 영향 없음 (구조적 한계는 시드 독립적)

**계획된 완화**: DKW 신뢰구간이 있는 다중 시드 시뮬레이션 (S1-S3) (검증 스크립트 V1-V8 참조).

### 5.2 토폴로지 빈티지

CAIDA 데이터는 2025년 1-7월을 포괄; 원 논문은 2013-2014 데이터를 사용하였다. 인터넷의 AS-level 토폴로지는 상당히 진화하였다:

- **Tor 릴레이 분포**: 유럽 호스팅 제공자 (Hetzner, OVH)로 이동, 미국 중심 transit 제공자에서 이탈
- **AS 연결성**: Hurricane Electric이 피어링을 적극적으로 확장; NTT의 상대적 중요성 감소
- **IXP 성장**: Internet Exchange Point의 급증으로 AS 관계 모델에 포착되지 않는 우회 경로 생성

이 빈티지 차이는 **순위 순서** (Tier A3)에 영향을 미치나 **구조적 속성** (Tier-1 지배, 방어 효과)에는 영향을 미치지 않는다.

### 5.3 시뮬레이션 규모 충분성

| 실험 | 회로 | 클라이언트 | 기간 | 통계적 검정력 |
|------|------|-----------|------|--------------|
| RAPTOR R1 | 7,776,600 | 200 | 90일 | 1% 이상 비율에 높음 |
| RAPTOR R2 | 15,552,600 | 200 | 180일 | 추세에 높음 |
| RAPTOR R3 | 19,441,500 | 500 | 90일 | 순위에 높음 |
| 네트워크 방어 | 1,944,150 | 50 | 60일 | 클라이언트 CDF에 보통 |
| 릴레이 적대자 | 15,552,600 | 200 | 180일 | 계단 함수에 높음 |

주요 규모 우려는 **50-클라이언트 네트워크 방어 실험**으로, 개별 클라이언트 타협이 CDF에서 2% 점프를 나타낸다. 200+ 클라이언트로 증가하면 CDF 곡선이 더 매끄러워질 것이다.

---

## 6. 요약 분류표

| ID | 주장 | 등급 | 신뢰도 | 핵심 근거 |
|----|------|------|--------|----------|
| A1 | 릴레이 적대자가 guard 교체 내 100% 타협 달성 | **A** | 강함 | 200/200 클라이언트, 60.0일, exit 90.5% |
| A2 | 방어 순서: Combined > Astoria >> CR > Vanilla | **A** | 강함 | 99.97% vs 4.6% 스트림 감소 |
| A3 | Tier-1 AS가 트래픽 상관 위협을 지배 | **A** | 강함 | 4/4 Tier-1이 top-6, Telia 순위 보존 |
| B1 | BGP churn이 시간에 따라 상관을 증가시킴 | **B** | 조건부 | 1.3-1.5x 증가 (논문: ~3x) |
| B2 | 비대칭 라우팅이 상관을 증가시킴 | **B** | 조건부 | 1.003x (논문: 1.66x) |
| B3 | BGP 공격이 상관을 높임 (국가 수준) | **B** | 조건부 | 국가 수준 공격에 1.84x 스파이크 |
| C1 | BGP interception이 ~90% 상관 달성 | **C** | 주장 불가 | 증가 관찰되지 않음 (토폴로지 한계) |
| C2 | 절대 상관율 값 | **C** | 주장 불가 | RAPTOR 값 대비 5-50x 격차 |

---

## 7. 연구 결론에 대한 시사점

### 확정적으로 진술할 수 있는 것:
1. Tor의 릴레이 선택 알고리즘은 릴레이 수준 적대자에 대해 예측 가능한 타협 타임라인을 생성한다.
2. Astoria 방식의 transit AS 중첩 회피가 Counter-RAPTOR guard 재가중치보다 극적으로 더 효과적이다.
3. Tier-1 transit AS는 토폴로지 규모에 관계없이 트래픽 상관에서 구조적으로 특권적 위치를 차지한다.

### 단서와 함께 진술할 수 있는 것:
4. BGP 라우팅 변화가 시간에 따라 적대자의 관측 집합을 확장한다 (규모 ~2x 과소추정).
5. 비대칭 라우팅이 추가 상관 기회를 생성한다 (방향 확인, 규모 불충분).
6. 국가 수준 BGP 공격이 상관율을 상당히 스파이크시킬 수 있다.

### 진술할 수 없는 것:
7. 실제 Tor 사용에 대한 구체적 절대 상관 백분율.
8. 인터넷 규모에서의 BGP interception 공격 효과.

---

## 부록: 주장-근거 추적표

| 주장 | JSON 보고서 | 핵심 필드 |
|------|------------|----------|
| A1 | `relay_adversary_report.json` | `relay_cdf.vanilla`, `stream_compromise.vanilla` |
| A2 | `network_defense_comparison_report.json` | `overall[*]`, `client_compromise[*]`, `trends` |
| A3 | `raptor_reproduction_report.json` | `R3_entity_threat.top15` |
| B1 | `raptor_reproduction_report.json` | `R2_temporal_churn.sym_curve`, `asym_curve` |
| B2 | `raptor_reproduction_report.json` | `R1_asymmetric_routing` |
| B3 | `network_defense_comparison_report.json` | `attack_impact` |
| C1 | `raptor_reproduction_report.json` | `R4_interception` |
| C2 | 모든 보고서 | 논문 참조값 대비 절대 비율 비교 |
