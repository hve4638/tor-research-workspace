# 라우팅 검증: AS 경로 길이 분포

**검증 테스트**: V2 (경로 길이 분포)
**데이터 소스**: `data/v2_path_length.json`
**플롯**: `plots/v2_path_length_histogram.png`

---

## 1. V2: AS 경로 길이 분포

### 1.1 방법론

Vanilla BGP 공격 시뮬레이션(`observations_bgp.ndjson`)에서 4,137,289개 관찰 레코드를 스트리밍하여 2,690,331개 고유 회로-세그먼트 쌍을 추출했다. 각 세그먼트(client-guard, guard-middle, middle-exit)에 대해 AS 경로 길이를 트랜짓 AS 수 + 두 엔드포인트로 계산했다.

### 1.2 결과

| 메트릭 | 우리 모델 | RIPE RIS 참조값 |
|--------|-----------|----------------|
| 평균 경로 길이 | 3.54 홉 | ~4.2 홉 |
| 중앙값 경로 길이 | 3.0 홉 | ~4 홉 |
| 표준 편차 | 0.63 | -- |
| 최소 | 3 | 1 |
| 최대 | 7 | 15+ |

**분포 상세**:

| 경로 길이 | 개수 | 비율 |
|----------|------|------|
| 3 홉 | 1,442,723 | 53.6% |
| 4 홉 | 1,054,118 | 39.2% |
| 5 홉 | 188,428 | 7.0% |
| 6 홉 | 4,930 | 0.2% |
| 7 홉 | 132 | 0.005% |

### 1.3 분석

모델의 평균 AS 경로 길이(3.54)가 RIPE RIS 인터넷 전체 평균(~4.2)보다 **0.66홉 짧다**. 이 편차는 예상된 것이며 설명 가능하다:

1. **서브그래프 효과**: 727-AS 토폴로지가 전체 인터넷보다 밀집해 있다.
2. **Tor 호스팅 편향**: Tor 릴레이가 잘 피어링된 호스팅 네트워크에 집중되어 있다.
3. **BFS 최단 경로 라우팅**: BFS가 항상 최단 유효 경로를 찾는 반면, 실제 BGP는 정책 선호로 더 긴 경로를 선택할 수 있다.

### 1.4 타당성에 대한 함의

짧은 경로는 시뮬레이터가 각 회로 세그먼트를 관찰할 수 있는 트랜짓 AS 수를 **과소평가**함을 의미한다. 이는 상관률 추정치를 **보수적**으로 만든다: 경로가 더 길면(현실처럼) 더 많은 트랜짓 AS가 각 세그먼트에 나타나 entry-exit 상관 확률이 증가할 것이다.

이 방향적 편향(짧은 경로 = 낮은 상관)은 우리의 결과가 실제 위협의 **하한**을 나타냄을 의미하며, 결론을 약화시키기보다 강화한다.

---

## 2. 요약

| 테스트 | 상태 | 핵심 발견 |
|--------|------|----------|
| V2 경로 길이 | PASS | 평균 3.54홉 vs RIPE 4.2; 보수적 편향 (짧은 경로 = 적은 트랜짓 관찰) |

**판정**: 경로 길이 분포는 Tor 중심 서브그래프에 대해 타당하다. 경로 길이의 체계적 과소평가는 상관 추정치를 보수적으로 만들어 AS 수준 감시 위험에 대한 결론을 강화한다.
