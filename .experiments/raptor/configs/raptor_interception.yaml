# R4: BGP Interception attack impact (RAPTOR Section 5 comparison)
simulation:
  mode: "longitudinal"
  duration: "90d"
  seed: 42
  tick_interval_ms: 60000
  time_scale: 0
  asymmetric_routing: true

network:
  as_model: "../tor-anal/output/snapshots/as_model_simplified_20250101.json"
  as_edges: "../tor-anal/data/model_edges_20250101.json"
  as_geo_map: "../tor-anal/output/as_geo_map.json"
  weights:
    wgg: 0.5869
    wgm: 1.0
    wgd: 0.5869
    wee: 0.5869
    wem: 0.0
    weg: 0.4131
    wed: 0.5869
    wmg: 0.4131
    wme: 0.4131
    wmm: 1.0
    wmd: 0.4131

temporal:
  enabled: true
  snapshot_dir: "../tor-anal/output/snapshots"
  model_pattern: "as_model_simplified_%s.json"
  edges_dir: "../tor-anal/data"
  edges_pattern: "model_edges_%s.json"
  dates:
    - "20250101"
    - "20250201"
    - "20250301"
  interval_days: 30

bgp:
  enabled: true
  attacks:
    # Attack 1: Cogent intercepts Hetzner traffic
    - type: "interception"
      attacker_as: "AS174"
      target_as: "AS24940"
      start_day: 10
      duration_hours: 168
      adversary_type: "single"

    # Attack 2: Level3 (Tier-1) intercepts AS60729
    - type: "interception"
      attacker_as: "AS3356"
      target_as: "AS60729"
      start_day: 30
      duration_hours: 168
      adversary_type: "tier1"

    # Attack 3: Hurricane Electric intercepts OVH
    - type: "interception"
      attacker_as: "AS6939"
      target_as: "AS16276"
      start_day: 50
      duration_hours: 168
      adversary_type: "single"

clients:
  count: 200
  distribution: "uniform"
  guard:
    init_mode: "fresh_start"
    max_sample_size: 60
    lifetime_days_min: 30
    lifetime_days_max: 60
    n_primary_guards: 3
  circuit:
    max_dirtiness_sec: 600
    circuits_per_client: 3

hidden_service:
  enabled: false

observer:
  mode: "passive"
  scope: "global"
  controlled_ases: []

output:
  observation_log: "output/raptor/obs_intercept.ndjson"
  ground_truth_log: "output/raptor/gt_intercept.ndjson"
